# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Commands

```bash
npm run dev        # Start Vite dev server with HMR at http://localhost:5173
npm run build      # TypeScript check + Vite production build
npm run preview    # Build then preview locally
npm run deploy     # Deploy to Cloudflare Workers via wrangler
npm run lint       # Run ESLint
npm run check      # Full check: tsc + vite build + wrangler dry-run
npm run cf-typegen # Regenerate worker-configuration.d.ts from wrangler bindings
npx wrangler tail  # Stream live Worker logs
```

## Architecture

This is a full-stack app with two distinct environments sharing one repo:

**Frontend** (`src/react-app/`) — React 19 + TypeScript, compiled by Vite. Entry point is `main.tsx`. The `tsconfig.app.json` covers only this directory.

**Backend** (`src/worker/`) — Hono app running on Cloudflare Workers. Entry point is `src/worker/index.ts`, declared as `main` in `wrangler.json`. The `tsconfig.worker.json` covers only this directory. Cloudflare bindings are typed via `worker-configuration.d.ts` (auto-generated by `wrangler types`).

**Build output** — Vite builds the React app into `dist/client/`, which is served as static assets by Cloudflare Workers. The worker handles API routes (`/api/*`) and falls back to the SPA for all other paths (`not_found_handling: single-page-application`).

**TypeScript** — Three separate tsconfig projects (`tsconfig.app.json`, `tsconfig.node.json`, `tsconfig.worker.json`) referenced by the root `tsconfig.json`. This keeps React DOM types and Worker types isolated.

## Adding Cloudflare Bindings

After adding KV, D1, R2, or other bindings to `wrangler.json`, run `npm run cf-typegen` to regenerate `worker-configuration.d.ts` and get the `Env` type updated. The Hono app is typed as `new Hono<{ Bindings: Env }>()`.
